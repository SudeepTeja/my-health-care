{"ast":null,"code":"import _slicedToArray from\"/Users/sudeepteja/Downloads/My_Health_Care/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useRef,useContext}from'react';import AuthContext from'../../store/auth-context';import{useHistory}from'react-router-dom';import classes from'./AuthForm.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AuthForm=function AuthForm(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLogin=_useState2[0],setIsLogin=_useState2[1];var emailInputRef=useRef();var passwordInputRef=useRef();var history=useHistory();var authCtx=useContext(AuthContext);var switchAuthModeHandler=function switchAuthModeHandler(){setIsLogin(function(prevState){return!prevState;});};var submitHandler=function submitHandler(event){event.preventDefault();var enteredEmail=emailInputRef.current.value;var enteredPassword=passwordInputRef.current.value;var url;if(isLogin){url='https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyCj20CGr34T7zi-8bsyviQuv3we0Es8FeI';}else{url='https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyCj20CGr34T7zi-8bsyviQuv3we0Es8FeI';}fetch(url,{method:'POST',body:JSON.stringify({email:enteredEmail,password:enteredPassword,returnSecureToken:true}),headers:{'Content-Type':'application/json'}}).then(function(res){if(res.ok){return res.json();}else{return res.json().then(function(data){var errorMessage='Authentication failed!';if(data&&data.error&&data.error.message){errorMessage=data.error.message;}alert(errorMessage);throw new Error(errorMessage);});}}).then(function(data){console.log(data);var expirationTime=new Date(new Date().getTime()+ +data.expiresIn*1000);if(data.registered){authCtx.login(data.idToken/*, expirationTime.toISOString()*/);history.replace('/profile');}else{setIsLogin(function(prevState){return!prevState;});}}).catch(function(err){alert(err.message);});};return/*#__PURE__*/_jsxs(\"section\",{className:classes.auth,children:[/*#__PURE__*/_jsx(\"h1\",{children:isLogin?'Login':'Sign Up'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.control,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Your Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",required:true,ref:emailInputRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.control,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Your Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",required:true,ref:passwordInputRef})]}),!isLogin&&/*#__PURE__*/_jsxs(\"div\",{className:classes.control,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Mobile no\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"mobile\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,children:[/*#__PURE__*/_jsx(\"button\",{children:isLogin?'Login':'Create Account'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:classes.toggle,onClick:switchAuthModeHandler,children:isLogin?'Create new account':'Login with existing account'})]})]})]});};export default AuthForm;","map":{"version":3,"names":["useState","useRef","useContext","AuthContext","useHistory","classes","AuthForm","isLogin","setIsLogin","emailInputRef","passwordInputRef","history","authCtx","switchAuthModeHandler","prevState","submitHandler","event","preventDefault","enteredEmail","current","value","enteredPassword","url","fetch","method","body","JSON","stringify","email","password","returnSecureToken","headers","then","res","ok","json","data","errorMessage","error","message","alert","Error","console","log","expirationTime","Date","getTime","expiresIn","registered","login","idToken","replace","catch","err","auth","control","actions","toggle"],"sources":["/Users/sudeepteja/Downloads/My_Health_Care/src/components/Auth/AuthForm.js"],"sourcesContent":["import { useState, useRef, useContext } from 'react';\nimport AuthContext from '../../store/auth-context';\nimport { useHistory } from 'react-router-dom';\n\n\nimport classes from './AuthForm.module.css';\n\nconst AuthForm = () => {\n  const [isLogin, setIsLogin] = useState(true);\n\n  const emailInputRef = useRef();\n  const passwordInputRef = useRef();\n\n  const history = useHistory();\n\n  const authCtx = useContext(AuthContext)\n\n  const switchAuthModeHandler = () => {\n    setIsLogin((prevState) => !prevState);\n  };\n\n  const submitHandler = (event) => {\n    event.preventDefault();\n\n    const enteredEmail = emailInputRef.current.value;\n    const enteredPassword =  passwordInputRef.current.value;\n    let url;\n    if (isLogin) {\n      url = 'https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyCj20CGr34T7zi-8bsyviQuv3we0Es8FeI';\n    } else {\n      url = 'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyCj20CGr34T7zi-8bsyviQuv3we0Es8FeI';\n    }\n\n    fetch(url, \n          {\n            method: 'POST',\n            body: JSON.stringify({\n              email: enteredEmail,\n              password:enteredPassword,\n              returnSecureToken: true \n            }),\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          }\n      ).then(res => {\n        if (res.ok) {\n          return res.json();\n        } else {\n          return res.json().then(data => {\n            let errorMessage = 'Authentication failed!';\n            if (data && data.error && data.error.message) {\n              errorMessage = data.error.message;\n            }\n            alert(errorMessage);\n            throw new Error(errorMessage);\n          });\n        }\n      }).then((data) => {\n        console.log(data);\n        const expirationTime = new Date(\n          new Date().getTime() + (+data.expiresIn * 1000)\n        );\n        if (data.registered) {\n          authCtx.login(data.idToken/*, expirationTime.toISOString()*/);\n          history.replace('/profile');\n        } else {\n          setIsLogin((prevState) => !prevState);\n        }\n        \n      }).catch((err) => {\n        alert(err.message);\n      })\n\n  }\n\n  return (\n    <section className={classes.auth}>\n      <h1>{isLogin ? 'Login' : 'Sign Up'}</h1>\n      <form onSubmit={submitHandler}>\n        <div className={classes.control}>\n          <label htmlFor='email'>Your Email</label>\n          <input type='email' id='email' required ref={emailInputRef} />\n        </div>\n        <div className={classes.control}>\n          <label htmlFor='password'>Your Password</label>\n          <input type='password' id='password' required ref={passwordInputRef} />\n        </div>\n        {!isLogin &&\n          <div className={classes.control}>\n            <label>Mobile no</label>\n            <input type='text' id='mobile' required />\n          </div>\n        }\n        <div className={classes.actions}>\n          <button>{isLogin ? 'Login' : 'Create Account'}</button>\n          <button\n            type='button'\n            className={classes.toggle}\n            onClick={switchAuthModeHandler}\n          >\n            {isLogin ? 'Create new account' : 'Login with existing account'}\n          </button>\n        </div>\n      </form>\n    </section>\n  );\n};\n\nexport default AuthForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}